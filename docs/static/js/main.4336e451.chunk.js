(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{142:function(e,t,n){e.exports=n.p+"static/media/mappin.da7c5886.svg"},143:function(e,t,n){e.exports=n.p+"static/media/client.832362f3.svg"},148:function(e,t,n){e.exports=n(297)},154:function(e,t,n){},171:function(e,t){},173:function(e,t){},184:function(e,t){},186:function(e,t){},213:function(e,t){},215:function(e,t){},216:function(e,t){},222:function(e,t){},224:function(e,t){},242:function(e,t){},245:function(e,t){},261:function(e,t){},264:function(e,t){},292:function(e,t,n){},297:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),o=n(53),i=n.n(o),r=(n(153),n(154),n(54)),c=n(81),l=n(140),u=n(141),m=n(146),g=n(145),h=n(308),d=n(309),f=n(307),p=n(310),v=n(37),M=n.n(v),y=n(142),E=n.n(y),b=n(143),S=n.n(b),w=(n(291),n(13)),j=n.n(w),k=(n(292),"localhost"===window.location.hostname?"http://localhost:5000/api/v1/messages":"github.io.parveenmittal1");function x(e){return fetch(k,{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))}var O=n(299),C=n(300),L=n(301),U=n(306),z=n(302),I=n(303),N=n(304),A=n(305),V=function(e){return s.a.createElement(O.a,{body:!0,className:"message-form"},s.a.createElement(C.a,null,"Welcome to the My site "),s.a.createElement(L.a,null,"Leave a message with your location !"),e.sendingMessage||e.sentMessage||e.haveUserLoction?e.sendingMessage||e.haveUserLoction?s.a.createElement("video",{autoPlay:!0,loop:!0,src:"https://media.giphy.com/media/hWSQvXbDDh8rlnoLOt/giphy.mp4"}):s.a.createElement(L.a,null,"Thanks for submitting a message"):s.a.createElement(z.a,{onSubmit:e.formSubmitted},s.a.createElement(I.a,{row:!0},s.a.createElement(N.a,{for:"name"},"Name"),s.a.createElement(A.a,{onChange:e.valueChanged,type:"text",name:"name",id:"name",placeholder:"enter your name"})),s.a.createElement(I.a,{row:!0},s.a.createElement(N.a,{for:"message"},"Message"),s.a.createElement(A.a,{onChange:e.valueChanged,type:"textarea",name:"message",id:"message",placeholder:"enter your message"})),s.a.createElement(U.a,{type:"submit",className:"btn btn-primary",color:"info",disabled:!e.formIsValid()},"Send")," "))},D=j.a.icon({iconUrl:E.a,iconSize:[50,81],iconAnchor:[0,41],popupAnchor:[0,-41]}),W=j.a.icon({iconUrl:S.a,iconSize:[50,81],iconAnchor:[0,41],popupAnchor:[0,-41]}),J=M.a.object().keys({name:M.a.string().alphanum().min(1).max(100).required(),message:M.a.string().min(1).max(100).required()}),P=function(e){Object(m.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={location:{lat:51.505,lng:-.09},zoom:13,userMessage:{name:"",message:""},sendingMessage:!1,sentMessage:!1,messages:[]},e.formIsValid=function(){var t={name:e.state.userMessage.name,message:e.state.userMessage.message};return!(M.a.validate(t,J).error&&!e.state.haveUserLoction)},e.formSubmitted=function(t){(t.preventDefault(),e.formIsValid())&&(e.setState({sendingMessage:!0}),x({name:e.state.userMessage.name,message:e.state.userMessage.message,latitude:e.state.location.lat,longitude:e.state.location.lng}).then((function(t){setTimeout((function(){e.setState({sendingMessage:!1,sentMessage:!0})}),4e3)})))},e.valueChanged=function(t){var n=t.target,a=n.name,s=n.value;e.setState((function(e){return{userMessage:Object(c.a)(Object(c.a)({},e.userMessage),{},Object(r.a)({},a,s))}}))},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;fetch(k).then((function(e){return e.json()})).then((function(e){var t={};return e.reduce((function(n,a){var s="".concat(a.latitude.toFixed(3),"+").concat(a.longitude.toFixed(3));return t[s]?(t[s].otherMessages=t[s].otherMessages||[],t[s].otherMessages.push(a)):(t[s]=e,n.push(a)),n}),[])})).then((function(t){e.setState({messages:t})})),new Promise((function(e){navigator.geolocation.getCurrentPosition((function(t){e({lat:t.coords.latitude,lng:t.coords.longitude})}),(function(){e(fetch("https://ipapi.co/json").then((function(e){return e.json()})).then((function(e){return{lat:e.latitude,lng:e.longitude}})))}))}),(function(){})).then((function(t){e.setState({location:t})}))}},{key:"render",value:function(){var e=[this.state.location.lat,this.state.location.lng];return s.a.createElement("div",{className:"map"},s.a.createElement(h.a,{className:"map",center:e,zoom:this.state.zoom},s.a.createElement(d.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.haveUserLocation?s.a.createElement(f.a,{position:e,icon:D}):"",",",this.state.messages.map((function(e){return s.a.createElement(f.a,{key:e._id,position:[e.latitude,e.longitude],icon:W},s.a.createElement(p.a,null,s.a.createElement("p",null,s.a.createElement("em",null,e.name,":")," ",e.message),e.otherMessages?e.otherMessages.map((function(e){return s.a.createElement("p",{key:e._id},s.a.createElement("em",null,e.name,":")," ",e.message)})):""))})),"}"),s.a.createElement(V,{sendingMessage:this.setState.sendingMessage,sentMessage:this.setState.sentMessage,haveUsersLocation:this.setState.haveUsersLocation,formSubmitted:this.formSubmitted,valueChanged:this.valueChanged,formIsValid:this.formIsValid}))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[148,1,2]]]);
//# sourceMappingURL=main.4336e451.chunk.js.map